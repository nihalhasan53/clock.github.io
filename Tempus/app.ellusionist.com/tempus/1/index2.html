<html class="ui-mobile"><head><base href="https://app.ellusionist.com/tempus/1/Options.html">
	<meta charset="UTF-8">
	<meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
	<meta name="Author" content="Stratagem Solutions Ltd, For Ellusionist.com, Inc">
	<meta name="format-detection" content="telephone=no">
	<title>Options</title>
	<link rel="stylesheet" href="switchery.min.css">
	<script src="./jquery-3.1.1.slim.min.js"></script>
	<script src="./jquery-1.10.2.min.js"></script>
	<script>
	jQuery(document).on("mobileinit", function() {
		jQuery.mobile.autoInitializePage = false;
	});
		</script>
	<script src="./jquery.mobile-1.4.5.min.js"></script>
	<script type="application/javascript" src="./fastclick.js"></script>
	
	<script src="switchery.min.js"></script>
	<script>
		var StackType = {Mnemonica: 0,
						 Aronson: 1,
						 Stebbins: 2,
						 NewDeckOrder: 3,
						 EightKings: 4,
						 RawNumber: 5};
		var LangType = {English: 0,
					   Français: 1,
					   Deutsche: 2,
					   Español: 3};
	var UseStackType;
	var ForceOnSpin;
	var ForceOnSpin2;
	var DoubleForce;
	var UseOffset;
	var RememberForce;
	var OffsetType = {Top: 0, Bottom: 1};
	var Licenced = false;
	var Language;
	
	</script>
	</head>
	
	<body style="background-color: white; backface-visibility: visible !important;" data-new-gr-c-s-check-loaded="14.1028.0" data-gr-ext-installed="">
	<div id="content">
	  <table id="optionsTable" align="center">
		<tbody>
		
		
		  <tr>
		  <td>Language </td>
		  <td><select id="language" class="needsclick">
			  <option value="0">English</option>
			  <option value="1">Français</option>
			  <option value="2">Deutsche</option>
			  <option value="3">Español</option>
			</select></td>
		</tr>
		<tr>
		  <td>Stack </td>
		  <td><select id="stack" class="needsclick">
			  <option value="0">Mnemonica</option>
			  <option value="1">Aronson</option>
			  <option value="2">Stebbins</option>
			  <option value="3">New Deck Order</option>
			  <option value="4">Eight Kings</option>
			  <option value="5">Number</option>
			</select></td>
		</tr>
		<tr>
		  <td>Force On Spin</td>
		  <td><input type="number" inputmode="numeric" pattern="[0-9]*" min="1" max="9" name="forceOnSpin" id="forceOnSpin" maxlength="1" value="3" title="Force On" style="width:30px; text-align:center; height:30px;"></td>
		</tr>
		<tr>
		  <td>Use Double Force</td>
		  <td><input type="checkbox" id="doubleForce" data-switchery="true" style="display: none;"><span class="switchery switchery-default" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s ease 0s, box-shadow 0.4s ease 0s;"><small style="left: 0px; transition: background-color 0.4s ease 0s, left 0.2s ease 0s;"></small></span></td>
		</tr>
		<tr>
		  <td>Second Force On Spin</td>
		  <td><input type="number" inputmode="numeric" pattern="[0-9]*" min="1" max="9" name="forceOnSpin2" id="forceOnSpin2" maxlength="1" value="3" title="Force On" style="width:30px; text-align:center; height:30px;"></td>
		</tr>
		<tr>
		  <td>Use Offset</td>
		  <td><input type="checkbox" id="useOffset" data-switchery="true" style="display: none;"><span class="switchery switchery-default" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s ease 0s, box-shadow 0.4s ease 0s;"><small style="left: 0px; transition: background-color 0.4s ease 0s, left 0.2s ease 0s;"></small></span></td>
		</tr>  
		<tr>
		  <td>Offset Type</td>
		  <td><select id="offsetType" class="needsclick">
			  <option value="0">Peek Top Card</option>
			  <option value="1">Peek Bottom Card</option>
			</select></td>
		</tr>  
		<tr>
		  <td>Remember Force on Quit</td>
		  <td><input type="checkbox" id="rememberForce" data-switchery="true" style="display: none;"><span class="switchery switchery-default" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s ease 0s, box-shadow 0.4s ease 0s;"><small style="left: 0px; transition: background-color 0.4s ease 0s, left 0.2s ease 0s;"></small></span></td>
		</tr>  
		
		<tr>
			<td>Version</td>
			<td>2.0.0</td>
		  </tr> 
		
		  <tr>
		</tr>
		  <tr>
			  <td colspan="2"><span style="color:red;">If the Timer wheels are rotating unusually slowly, ensure you've switched off Low Power/Battery Saver mode.<br>If you're unable to set the force value, hit Cancel on the Timer screen first.</span></td>
		</tr>
		<tr>
			<td colspan="2"><button type="button" id="btnCloseOptions" onclick="btnCloseOptionsClickHandler()" style="width:60%">Close Options</button></td>
		  </tr>
	  </tbody></table>
	</div>
	<script>
		function btnCloseOptionsClickHandler() {
			this.parent.document.querySelector('a.close').click();
		}
	
		function submitLicense(){
			document.getElementById("submitLicense").disabled = true;
	
			//Check license
			$.ajax({
					type: "POST",
					url: "//app.ellusionist.com/webapi/Tempus_Validate.php" ,
					data: { key: $("#LicenceKey").val() },
					success : function(result) { 
						if(result === "YAY!"){
							localStorage.setItem("Tempus-LicenseKey", JSON.stringify($("#LicenceKey").val()));
							document.getElementById("LicenceKey").disabled = true;
							document.getElementById("LicenceKey").value = "Licensed";
							document.getElementById("submitLicense").disabled = true;
							localStorage.setItem("Tempus-Licenced", JSON.stringify(true));
							document.getElementById("optionsTable").deleteRow(0);
							document.getElementById("optionsTable").deleteRow(0);
							alert("License Activated");
						}
						else{
							alert("Invalid License Key");
							document.getElementById("submitLicense").disabled = false;
						}
					},
					error : function(xhr, status, error){
							if (xhr.responseText != "") {
								var jsonResponseText = $.parseJSON(xhr.responseText);
								var jsonResponseStatus = '';
								var message = '';
								$.each(jsonResponseText, function(name, val) {
									if (name == "ResponseStatus") {
										jsonResponseStatus = $.parseJSON(JSON.stringify(val));
										 $.each(jsonResponseStatus, function(name2, val2) {
											 if (name2 == "Message") {
												 message = val2;
											 }
										 });
									}
								});
								alert('Message' + message);
							}
							else{
								alert('Message' + error);
							}
							document.getElementById("submitLicense").disabled = false;
						}
				});
		}
	
	function updateCheck()
	{
		"use strict";
		if(location.hostname.match('ellusionist'))
		{	
			//Only attempt to update application cache when deployed
			if(JSON.parse(localStorage.getItem("Tempus-automaticallyUpdated")))
			{
				
			}
			else
			{
				$("#updateButton").text("Checking For Update...")
				try{
				}
				catch(err){
					alert("Something went wrong. Ensure the app is added to your home screen.")
					$("#updateButton").text("Check For Update");
				}
				
			}
		}
		else
		{
			alert("Unable to update. Error code 1");		
		}
	}
	
		
	var doubleforceswitch = new Switchery(document.querySelector('#doubleForce'));
	var doubleforceswitchbase = document.getElementById('doubleForce');
	doubleforceswitchbase.onchange = function() {
		DoubleForce = doubleforceswitchbase.checked;
		localStorage.setItem("Tempus-DoubleForce", JSON.stringify(DoubleForce));
	};
		
	var useoffsetswitch = new Switchery(document.querySelector('#useOffset'));
	var useoffsetswitchbase = document.getElementById('useOffset');
	useoffsetswitchbase.onchange = function() {
		UseOffset = useoffsetswitchbase.checked;
		localStorage.setItem("Tempus-UseOffset", JSON.stringify(UseOffset));
	};
	var rememberforceswitch = new Switchery(document.querySelector('#rememberForce'));
	var rememberforceswitchbase = document.getElementById('rememberForce');
	rememberforceswitchbase.onchange = function() {
		RememberForce = rememberforceswitchbase.checked;
		localStorage.setItem("Tempus-RememberForce", JSON.stringify(RememberForce));
	};
	
	function initialise()
	{
		if ('addEventListener' in document) {
			document.addEventListener('DOMContentLoaded', function() {"use strict";
				FastClick.attach(document.body);
			}, false);
		}
		
		Licenced = JSON.parse(localStorage.getItem("Tempus-Licenced"));
		Language = JSON.parse(localStorage.getItem("Tempus-Language"));
		UseStackType = JSON.parse(localStorage.getItem("Tempus-UseStackType"));
		ForceOnSpin = JSON.parse(localStorage.getItem("Tempus-ForceOnSpin"));
		ForceOnSpin2 = JSON.parse(localStorage.getItem("Tempus-ForceOnSpin2"));
		DoubleForce = JSON.parse(localStorage.getItem("Tempus-DoubleForce"));
		UseOffset = JSON.parse(localStorage.getItem("Tempus-UseOffset"));
		OffsetType = JSON.parse(localStorage.getItem("Tempus-OffsetType"));
		RememberForce = JSON.parse(localStorage.getItem("Tempus-RememberForce"));
	
		document.getElementById('stack').value = UseStackType;
		document.getElementById('language').value = Language;
		document.getElementById('offsetType').value = OffsetType;
		document.getElementById("forceOnSpin").value = ForceOnSpin
		document.getElementById("forceOnSpin2").value = ForceOnSpin2
		if(DoubleForce){
			doubleforceswitchbase.checked = true;
			doubleforceswitch.handleOnchange(true);
		}
		if(UseOffset){
			useoffsetswitchbase.checked = true;
			useoffsetswitch.handleOnchange(true);
		}
		if(RememberForce){
			rememberforceswitchbase.checked = true;
			rememberforceswitch.handleOnchange(true);
		}
	}
		initialise();
		document.getElementById("forceOnSpin").oninput = function () {
		if (this.value.length > 1) {
			this.value = this.value.slice(0,1);
		}
		localStorage.setItem("Tempus-ForceOnSpin", JSON.stringify(parseInt(this.value)));	
	}
		document.getElementById("forceOnSpin2").oninput = function () {
		if (this.value.length > 1) {
			this.value = this.value.slice(0,1);
		}
		localStorage.setItem("Tempus-ForceOnSpin2", JSON.stringify(parseInt(this.value)));	
	}
		document.getElementById("stack").onchange = function(){
		localStorage.setItem("Tempus-UseStackType", JSON.stringify(parseInt(this.value)));	
		};
		document.getElementById("language").onchange = function(){
		localStorage.setItem("Tempus-Language", JSON.stringify(parseInt(this.value)));	
		};	
		document.getElementById("offsetType").onchange = function(){
		localStorage.setItem("Tempus-OffsetType", JSON.stringify(parseInt(this.value)));	
		};
		if(Licenced){
			document.getElementById("LicenceKey").disabled = true;
			document.getElementById("LicenceKey").value = "Licensed";
			document.getElementById("submitLicense").disabled = true;
			document.getElementById("optionsTable").deleteRow(0);
			document.getElementById("optionsTable").deleteRow(0);
		}
		
		
	</script>
	
	
	</body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>